---
import type { CollectionEntry } from 'astro:content'
import { CATEGORIES } from '@/data/categories'
import PostCard from '@/components/PostCard'
import { cn } from '@/utils'

type Props = {
	posts: CollectionEntry<'blog'>[]
	FirstBig?: boolean
}

const { posts, FirstBig = false } = Astro.props
// Create a map for the posts.
let map = new Map()
posts.forEach((element) => {
	const currentCat = element.data.category
	const currentSubCat = element.data.subcategory
	if (map.has(currentCat)) {
		map.get(currentCat).add(currentSubCat)
	} else {
		map.set(currentCat, new Set([currentSubCat]))
	}
})
---

<div class='flex flex-col'>
	<div class='flex gap-5'>
		<section
			class={cn(
				`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3  gap-8 mt-3`,
				FirstBig && `md:[&>*:first-child]:col-span-2`
			)}
		>
			{
				posts.map(async (post) => {
					const { remarkPluginFrontmatter } = await post.render()

					return (
						<PostCard
							id={post.id}
							data={post.data}
							slug={post.slug}
							readTime={remarkPluginFrontmatter.minutesRead}
						/>
					)
				})
			}
		</section>
	</div>
</div>
<script></script>
